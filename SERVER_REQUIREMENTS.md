# 服务器配置要求

## 最低配置（小数据量，<1000条）

| 配置项 | 最低要求 | 推荐配置 |
|--------|---------|---------|
| CPU | 1 核 | 2 核 |
| 内存 | 1 GB | 2 GB |
| 存储 | 2 GB 可用空间 | 5 GB 可用空间 |
| 操作系统 | Linux/Windows/macOS | Linux (Ubuntu 20.04+) |
| Node.js | v18.x 或更高 | v20.x |
| 网络 | 稳定的互联网连接 | 稳定高速连接 |

## 推荐配置（中等数据量，1000-10000条）

| 配置项 | 最低要求 | 推荐配置 |
|--------|---------|---------|
| CPU | 2 核 | 4 核 |
| 内存 | 2 GB | 4 GB |
| 存储 | 5 GB 可用空间 | 10 GB 可用空间 |
| 操作系统 | Linux | Linux (Ubuntu 20.04+) |
| Node.js | v20.x | v20.x |
| 网络 | 稳定的互联网连接 | 高速连接 |

## 高性能配置（大数据量，>10000条）

| 配置项 | 最低要求 | 推荐配置 |
|--------|---------|---------|
| CPU | 4 核 | 8 核 |
| 内存 | 4 GB | 8 GB |
| 存储 | 10 GB 可用空间 | 20 GB 可用空间 |
| 操作系统 | Linux | Linux (Ubuntu 20.04+) |
| Node.js | v20.x | v20.x |
| 网络 | 高速互联网连接 | 高速连接 |

## 资源使用分析

### 内存使用

| 场景 | 内存占用 | 说明 |
|------|---------|------|
| 程序启动 | 100-200 MB | Node.js 运行时 + 依赖加载 |
| 加载 1000 条数据 | +50-100 MB | Excel 文件解析 |
| 加载 10000 条数据 | +300-500 MB | 大文件解析 |
| 并发处理（10个） | +100-200 MB | 请求处理 + 结果缓存 |
| 总计（小数据） | 200-300 MB | <1000 条数据 |
| 总计（中数据） | 400-600 MB | 1000-10000 条数据 |
| 总计（大数据） | 600-1000 MB | >10000 条数据 |

### CPU 使用

| 操作 | CPU 占用 | 持续时间 |
|------|---------|---------|
| Excel 文件读取 | 高（80-100%） | 几秒到几十秒 |
| 数据解析 | 中（30-50%） | 几秒 |
| 并发处理 | 低-中（20-40%） | 持续 |
| 保存结果 | 低（5-10%） | 短暂 |

### 存储使用

| 类型 | 用途 | 大小估算 |
|------|------|---------|
| 代码和依赖 | 程序文件 | 500MB - 1GB |
| 临时文件 | CSV 结果文件 | 每100条约 10-50KB |
| 日志文件 | 运行日志 | 约 1-5MB |
| 总计 | - | 约 1GB + 数据量 |

## 网络要求

### API 调用

- **平均延迟**：500-3000ms/请求（取决于网络和模型）
- **带宽要求**：1-5 Mbps（建议 10 Mbps 以上）
- **稳定性**：非常重要，网络不稳定会导致频繁重试

### 上传/下载

- **Excel 上传**：文件大小通常 < 50MB
- **结果下载**：每 100 条约 10-50KB CSV 文件

## 环境依赖

### 必需软件

- **Node.js**：v18.x 或更高（推荐 v20.x）
- **pnpm**：v9.0.0 或更高
- **操作系统**：
  - Linux（推荐）：Ubuntu 20.04+, Debian 11+, CentOS 8+
  - Windows：Windows 10/11
  - macOS：macOS 11+

### 可选依赖

- **Git**：用于代码管理
- **Nginx**：用于生产环境反向代理（可选）

## 性能调优建议

### 小数据量配置（<1000条）

```json
{
  "concurrentBatchSize": 5,
  "llmCallTimeout": 30,
  "maxRetries": 3,
  "retryDelay": 2,
  "saveInterval": 100
}
```

### 中等数据量配置（1000-10000条）

```json
{
  "concurrentBatchSize": 10,
  "llmCallTimeout": 30,
  "maxRetries": 5,
  "retryDelay": 2,
  "saveInterval": 100
}
```

### 大数据量配置（>10000条）

```json
{
  "concurrentBatchSize": 10,
  "llmCallTimeout": 30,
  "maxRetries": 5,
  "retryDelay": 2,
  "saveInterval": 100
}
```

**注意**：即使是大数据量，建议保持并发数 ≤ 10，避免 API 限流。

## 常见场景

### 场景 1：个人电脑运行

**配置**：
- CPU：2 核
- 内存：4 GB
- 网络：家庭宽带

**适用数据量**：<5000 条

**预期性能**：处理 1000 条约 5-10 分钟

### 场景 2：小型服务器

**配置**：
- CPU：2-4 核
- 内存：4-8 GB
- 网络：服务器网络

**适用数据量**：1000-20000 条

**预期性能**：处理 10000 条约 60-120 分钟

### 场景 3：云服务器

**配置**：
- CPU：4-8 核
- 内存：8-16 GB
- 网络：高速云网络

**适用数据量**：>10000 条

**预期性能**：处理 20000 条约 120-240 分钟

## 注意事项

1. **网络稳定性**：网络不稳定会导致频繁重试，增加处理时间和 API 调用成本
2. **API 限流**：并发数过高可能导致 API 限流，建议保持并发数 ≤ 10
3. **内存管理**：程序会定期清空内存中的结果数组，但大文件仍会占用较多内存
4. **磁盘空间**：确保有足够的磁盘空间存储临时文件和日志
5. **超时设置**：网络较慢时，增加超时时间（30-60秒）

## 成本估算

### API 调用成本

假设使用 DeepSeek V3 模型，每 1K tokens 约 ¥0.001-0.01：

| 数据量 | 平均文本长度 | 总 tokens | 预估成本 |
|--------|------------|----------|---------|
| 1,000 | 100 字 | 150K | ¥0.15-1.5 |
| 10,000 | 100 字 | 1.5M | ¥1.5-15 |
| 100,000 | 100 字 | 15M | ¥15-150 |

*注：实际成本取决于使用的模型和计费标准*

### 服务器成本

| 云服务商 | 配置 | 月成本 |
|---------|------|--------|
| 阿里云 | 2核4GB | 约 ¥50-100 |
| 腾讯云 | 2核4GB | 约 ¥50-100 |
| AWS | 2核4GB | 约 ¥150-200 |

## 监控建议

1. **CPU 使用率**：监控处理高峰期的 CPU 占用
2. **内存使用**：监控内存占用，避免 OOM
3. **网络延迟**：监控 API 调用延迟
4. **错误率**：监控重试次数和失败率
5. **磁盘空间**：监控临时文件和日志大小
